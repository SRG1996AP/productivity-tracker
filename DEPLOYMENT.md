# Productivity Tracker - Deployment Guide

## Quick Start: Deploy to Railway.app (Recommended)

Railway.app is the easiest way to deploy. It's free to start and handles everything for you.

### Step 1: Sign Up & Connect GitHub
1. Go to https://railway.app
2. Click "Sign up" (use GitHub account)
3. Authorize Railway to access your GitHub

### Step 2: Initialize Git Repository
```powershell
cd c:\Users\edwin\Desktop\productivity_tracker

# Initialize Git
git init
git add .
git commit -m "Initial commit - productivity tracker"

# Create a GitHub repository first at https://github.com/new
# Then add remote
git remote add origin https://github.com/YOUR-USERNAME/productivity-tracker.git
git branch -M main
git push -u origin main
```

### Step 3: Deploy on Railway
1. Go to https://railway.app/dashboard
2. Click "New Project"
3. Select "Deploy from GitHub repo"
4. Select your `productivity-tracker` repository
5. Click "Deploy"

### Step 4: Configure Environment Variables
In Railway dashboard:
1. Go to your project
2. Click "Variables"
3. Add these variables:
   ```
   FLASK_ENV=production
   FLASK_APP=wsgi.py
   SECRET_KEY=<generate a strong random key>
   DATABASE_URL=<auto-generated PostgreSQL URL>
   ```

To generate a strong SECRET_KEY:
```python
# Run this in Python
import secrets
print(secrets.token_urlsafe(32))
```

### Step 5: Initialize Database
1. In Railway, click on your project
2. Go to "Deployments" tab
3. Click the latest deployment
4. Select "Logs" to monitor
5. The database will auto-initialize on first deploy

---

## Alternative: Deploy to Render.com

### Step 1: Prepare
```powershell
# Make sure you have Git initialized and GitHub repo ready
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/YOUR-USERNAME/productivity-tracker.git
git push -u origin main
```

### Step 2: Deploy on Render
1. Go to https://render.com
2. Click "New +" → "Web Service"
3. Connect your GitHub repository
4. Fill in:
   - **Name**: productivity-tracker
   - **Environment**: Python 3
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `gunicorn wsgi:app`

### Step 3: Add Environment Variables
In Render dashboard:
1. Go to your service
2. Click "Environment"
3. Add:
   ```
   FLASK_ENV=production
   SECRET_KEY=<strong random key>
   DATABASE_URL=<PostgreSQL URL from Render database>
   ```

---

## Alternative: Deploy to Heroku

*Note: Heroku no longer offers free tier (2022)*

### If using paid Heroku:
```powershell
# Install Heroku CLI
# Login
heroku login

# Create app
heroku create your-app-name

# Set environment variables
heroku config:set FLASK_ENV=production
heroku config:set SECRET_KEY=<strong random key>

# Deploy
git push heroku main

# Initialize database
heroku run python -c "from app import create_app, db; app = create_app(); app.app_context().push(); db.create_all()"
```

---

## Local Testing Before Deployment

### Test production build locally:
```powershell
# Install dependencies
pip install -r requirements.txt

# Set environment variables (Windows PowerShell)
$env:FLASK_ENV = "production"
$env:SECRET_KEY = "test-secret-key"
$env:DATABASE_URL = "sqlite:///test.db"

# Run with gunicorn
gunicorn wsgi:app

# Should be accessible at http://localhost:8000
```

---

## Post-Deployment Tasks

### 1. Create Admin User
After deployment, SSH into your app:

**Railway:**
```bash
railway run python
```

Then in Python:
```python
from app import create_app, db
from app.models import User, Department
import uuid

app = create_app()
app.app_context().push()

# Create departments
departments = ['Sales', 'Support', 'Engineering', 'Marketing', 'HR', 'Finance', 'Operations', 'Management']
for dept_name in departments:
    if not Department.query.filter_by(name=dept_name).first():
        db.session.add(Department(name=dept_name))
db.session.commit()

# Create admin user
from flask_bcrypt import Bcrypt
bcrypt = Bcrypt()
admin = User(
    name='Admin User',
    employee_id='ADMIN001',
    department='Management',
    login_id='admin',
    password=bcrypt.generate_password_hash('your-secure-password').decode('utf-8'),
    is_admin=True
)
db.session.add(admin)
db.session.commit()

print("Admin user created!")
exit()
```

### 2. Verify Domain
- Railway provides a public URL automatically
- Customize domain in settings
- Update any hardcoded URLs if needed

### 3. Monitor Logs
Keep checking deployment logs for errors:
```
# Railway
railway logs

# Render
View in dashboard → Logs

# Heroku
heroku logs --tail
```

---

## Security Checklist

- [ ] **SECRET_KEY**: Use strong, random value (not 'dev-secret-key')
- [ ] **DEBUG**: Make sure `debug=False` in production
- [ ] **HTTPS**: Enabled by default on Railway/Render
- [ ] **Database**: Using PostgreSQL (not SQLite)
- [ ] **Backups**: Set up automatic backups for PostgreSQL
- [ ] **Environment Variables**: All sensitive data in .env, not in code
- [ ] **CSRF**: Enabled for form security

---

## Troubleshooting

### App crashes on startup
- Check logs for database connection errors
- Verify DATABASE_URL is set correctly
- Ensure migrations are running

### 404 on routes
- Check that Flask app is recognizing blueprints
- Verify run command points to `wsgi.py`

### Static files not loading
- Make sure `app/static/` directory exists
- No changes needed - Flask handles this

### Database migration errors
- Drop and recreate database if stuck
- Or use fresh PostgreSQL on Railway/Render

---

## Need Help?

- **Railway Docs**: https://docs.railway.app
- **Render Docs**: https://render.com/docs
- **Heroku Docs**: https://devcenter.heroku.com

